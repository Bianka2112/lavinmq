name: avalanchemq
base: core18
version: '0.9.14'
summary: Lean and mean AMQP server # 79 char long summary
description: |
  An high throughput and advanced message queue server.

grade: devel # must be 'stable' to release into candidate/stable channels
confinement: strict # use 'strict' once you have the right plugs and slots

apps:
  avalanchemq:
    command: avalanchemq -c $SNAP_DATA/etc/avalanchemq/avalanchemq.conf
    daemon: simple
    plugs:
      - network
      - network-bind

  avalanchemqperf:
    command: avalanchemqperf
    plugs:
      - network

parts:
  avalanchemq:
    plugin: crystal
    source: .
    build-packages:
      - git
      - libssl-dev
      - libevent-dev

layout:
  /var/lib/avalanchemq:
    symlink: $SNAP_DATA/var/lib/avalanchemq
  /etc/avalanchemq/avalanchemq.conf:
    symlink: $SNAP_DATA/etc/avalanchemq/avalanchemq.conf
